<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwill.steam.review.mapper.ReviewMapper">
	
	<!-- 게임 리뷰 작성 -->
	<insert id="insertGameReview" parameterType="com.itwill.steam.review.Review">
		<selectKey resultType="java.lang.Integer" keyProperty="reviewNo" order="BEFORE">
			select review_review_no_seq.nextval from dual
		</selectKey>
			insert into review(review_no, review_created_at, review_updated_at, review_comment, review_recommend, review_like, review_dislike, u_no, g_no) 
			values(#{reviewNo}, sysdate, sysdate, #{reviewComment}, #{reviewRecommend}, #{reviewLike}, #{reviewDisLike}, #{user.uNo}, #{game.gNo})
	</insert>
		
	<!-- 게임 리뷰 삭제 -->
	<delete id="deleteGameReview">
		delete from review where review_no=#{reviewNo}
	</delete>
	
	<!-- 게임 리뷰 수정 -->
	<update id="updateGameReview" parameterType="com.itwill.steam.review.Review">
		update review set review_updated_at=sysdate, review_comment=#{reviewComment}, review_recommend=#{reviewRecommend} where review_no=#{reviewNo}
	</update>
	
	<!-- 회원번호로 리뷰 전체보기 -->
	<select id="selectByUserNo" parameterType="com.itwill.steam.user.User" resultType="com.itwill.steam.review.Review">
		select * from review where u_no=#{uNo}
	</select>
	
	<!-- 게임번호로 리뷰 전체보기 -->
	<select id="selectByGameNo" parameterType="com.itwill.steam.game.Game" resultType="com.itwill.steam.review.Review">
		select * from review where g_no=#{gNo}
	</select>
	
	<!-- 리뷰 최신등록순 정렬보기 -->
	<select id="selectByDateDesc" parameterType="com.itwill.steam.review.Review" resultType="com.itwill.steam.review.Review">
		select * from review order by review_created_at desc, review_updated_at desc
	</select>
		
	<!-- 추천수 많은 리뷰 정렬보기 -->
	<select id="selectByLikeDesc" parameterType="com.itwill.steam.review.Review" resultType="com.itwill.steam.review.Review">
		select * from review order by review_like desc
	</select>
	
	
</mapper>